#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>

struct vuln{
    char name[0x20];
    int age;
};

void pwn(int size, struct vuln *_target){
    if( size > 0x20 ){
        printf("Out-Of-Memory\n");
        exit(-1);
    }
    printf("What's your name?\n");
    read(0, _target->name, size);
    printf("Your Age?\n");
    scanf("%d", &_target->age);
}

int main(int argc, char *argv[]){
    setvbuf(stdin, 0, 2, 0);
    setvbuf(stdout, 0, 2, 0);
    setvbuf(stderr, 0, 2, 0);
    printf("OOB Sample\n");
    struct vuln *target = malloc(sizeof(struct vuln));
    int size;
    printf("How much size of your name length?\n");
    scanf("%d", &size);
    pwn(size, target);

    return 0;
}
